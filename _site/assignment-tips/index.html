

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/sp25/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/sp25/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

.site-nav > ul.nav-list:first-child > li:not(:nth-child(6)) > a,
.site-nav > ul.nav-list:first-child > li > ul > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a {
  background-image: none;
}

.site-nav > ul.nav-list:not(:first-child) a,
.site-nav li.external a {
  background-image: none;
}

.site-nav > ul.nav-list:first-child > li:nth-child(6) > a {
  font-weight: 600;
  text-decoration: none;
}.site-nav > ul.nav-list:first-child > li:nth-child(6) > button svg {
  transform: rotate(-90deg);
}.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(6) > ul.nav-list {
  display: block;
}
  </style>

  

  
    <script src="/sp25/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/sp25/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/sp25/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Assignment Tips | Data 101 / Info 258</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Assignment Tips" />
<meta name="author" content="Data 101 Course Staff" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="PostgreSQL and jupysql tips" />
<meta property="og:description" content="PostgreSQL and jupysql tips" />
<link rel="canonical" href="http://localhost:4000/sp25/assignment-tips/" />
<meta property="og:url" content="http://localhost:4000/sp25/assignment-tips/" />
<meta property="og:site_name" content="Data 101 / Info 258" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Assignment Tips" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Data 101 Course Staff"},"description":"PostgreSQL and jupysql tips","headline":"Assignment Tips","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/sp25/data-101-logo.png"},"name":"Data 101 Course Staff"},"url":"http://localhost:4000/sp25/assignment-tips/"}</script>
<!-- End Jekyll SEO tag -->


    <!-- Use this to add global CSS/JS utitlties. -->

  <!-- Loading the v6 core styles and the Solid and Brands styles -->
  <link href="/sp25/assets/vendor/fontawesome/css/fontawesome.min.css"
  rel="stylesheet" />
  <link href="/sp25/assets/vendor/fontawesome/css/regular.min.css" rel="stylesheet" />
  <link href="/sp25/assets/vendor/fontawesome/css/solid.min.css" rel="stylesheet" />
  <!-- <link href="/sp25/assets/vendor/fontawesome/css/brands.css" rel="stylesheet" /> -->


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/sp25/" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="Data 101 / Info 258"></div>

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><a href="/sp25/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/sp25/calendar/" class="nav-list-link">Weekly Schedule</a></li><li class="nav-list-item"><a href="/sp25/syllabus/" class="nav-list-link">Syllabus</a></li><li class="nav-list-item"><a href="/sp25/staff/" class="nav-list-link">Staff</a></li><li class="nav-list-item"><a href="/sp25/assignments/final-project/" class="nav-list-link">Optional Final Project</a></li><li class="nav-list-item"><a href="/sp25/assignment-tips/" class="nav-list-link">Assignment Tips</a></li><li class="nav-list-item"><a href="/sp25/resources/" class="nav-list-link">Resources</a></li><li class="nav-list-item"><a href="/sp25/acknowledgments/" class="nav-list-link">Acknowledgments</a></li></ul>

  <ul class="nav-list"><li class="nav-list-item external">
          <a href="https://data101.org/sp25faq" class="nav-list-link external"
            
          >
            Course FAQ
            
          </a>
        </li><li class="nav-list-item external">
          <a href="https://data101.org/notes" class="nav-list-link external"
            
          >
            Course Notes
            
          </a>
        </li></ul>
</nav>


  
  
    <!-- This file adds links at the bottom of the sidebar on the left. -->


<section class="site-footer py-1" aria-label="Footer: site archive">
  <a href="/"
    target="_blank" rel="noopener nofollow">View all course offerings
  </a>
</section>



  <div class="site-footer m-1">
    

<span class="fs-3">
  <button type="button"
    class="btn js-toggle-dark-mode btn-outline"
    style="margin-right: -3px; border-top-right-radius: 0; border-bottom-right-radius: 0;"
    aria-label="Switch to Dark Mode">🌙 Dark Mode</button>
  <button type="button"
    class="btn js-unset-color-scheme btn-outline px-2"
    style="margin-left: -3px; border-top-left-radius: 0; border-bottom-left-radius: 0;"
    aria-label="Automatically switch theme"
    ><i class="fa-solid fa-rotate" title="Automatically switch theme"></i></button>
</span>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    if (!jtd) { return; }

    const toggleSchemeBtn = document.querySelector('.js-toggle-dark-mode');
    const unsetColorScheme = document.querySelector('.js-unset-color-scheme');

    // If the browser suggests a color scheme, and user hasn't saved/switch one yet..
    if (window.matchMedia && !localStorage['jtd-theme']) {
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        jtd.setTheme('dark');
        toggleSchemeBtn.textContent = '🔆 Light Mode';
        toggleSchemeBtn.ariaLabel = 'Switch to Light Mode';
      } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
        jtd.setTheme('light');
        toggleSchemeBtn.textContent = '🌙 Dark Mode';
        toggleSchemeBtn.ariaLabel = 'Switch to Dark Mode';
      }
    } else if (localStorage['jtd-theme']) {
      jtd.setTheme(localStorage['jtd-theme']);
    }

    jtd.addEvent(toggleSchemeBtn, 'click', function() {
      if (jtd.getTheme() === 'dark') {
        localStorage['jtd-theme'] = 'light';
        jtd.setTheme('light');
        toggleSchemeBtn.textContent = '🌙 Dark Mode';
        toggleSchemeBtn.ariaLabel = 'Switch to Dark Mode';
      } else {
        jtd.setTheme('dark');
        localStorage['jtd-theme'] = 'dark';
        toggleSchemeBtn.textContent = '🔆 Light Mode';
        toggleSchemeBtn.ariaLabel = 'Switch to Light Mode';
      }
    });

    // Add a way to unset the saved theme.
    // "default" respect's the site config setting, but not the user browser pref
    // So, check the pref and set the theme to the preferred one, if possible.
    jtd.addEvent(unsetColorScheme, 'click', function() {
      delete localStorage['jtd-theme'];

      if (window.matchMedia) {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          jtd.setTheme('dark');
        } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
          jtd.setTheme('light');
        }
      } else {
        jtd.setTheme('default');
      }
    });
  });
</script>

  </div>


  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Data 101 / Info 258" aria-label="Search Data 101 / Info 258" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://data101.org/notes" class="site-button"
          
        >
          Course Notes
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://data101.datahub.berkeley.edu" class="site-button"
          
        >
          DataHub
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSca-Tc9_uDAX-cgWZD9R_xU3dTofsklgO23qd04upbIYtGs3A/viewform" class="site-button"
          
        >
          Additional Extensions
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      
      <div id="main-content" class="main-content">
        <main>
          
            <!-- TODO: The Ed URL should be a site variable. -->
<h1 id="assignment-tips">
  
  
    <a href="#assignment-tips" class="anchor-heading" aria-labelledby="assignment-tips"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Assignment Tips
  
  
</h1>
    

<p class="no_toc text-delta">Author: Lisa Yan, Michael Ball, Rebecca Dang
Last updated: October 25, 2024 (Fall 2024)</p>

<p>Quick links:</p>
<ul>
  <li><a href="/sp25/assignments/final-project-tips">Final Project Tips</a></li>
</ul>

<p>Jump to:</p>
<ol id="markdown-toc">
  <li><a href="#assignment-tips" id="markdown-toc-assignment-tips">Assignment Tips</a>    <ol>
      <li><a href="#datahub" id="markdown-toc-datahub">DataHub</a>        <ol>
          <li><a href="#working-with-jupyter-notebooks" id="markdown-toc-working-with-jupyter-notebooks">Working with Jupyter Notebooks</a></li>
          <li><a href="#jupyterhub-keyboard-shortcuts" id="markdown-toc-jupyterhub-keyboard-shortcuts">JupyterHub Keyboard Shortcuts</a></li>
          <li><a href="#navigating-long-notebooks" id="markdown-toc-navigating-long-notebooks">Navigating Long Notebooks</a></li>
          <li><a href="#split-screen-setup" id="markdown-toc-split-screen-setup">Split-screen Setup</a></li>
          <li><a href="#help-why-is-my-datahub-so-slow" id="markdown-toc-help-why-is-my-datahub-so-slow">Help! Why is my DataHub so slow?</a></li>
          <li><a href="#help-i-cant-export-my-notebook-to-a-pdf" id="markdown-toc-help-i-cant-export-my-notebook-to-a-pdf">Help! I can’t export my notebook to a PDF</a></li>
        </ol>
      </li>
      <li><a href="#jupysql-postgresql-via-ipython-magic" id="markdown-toc-jupysql-postgresql-via-ipython-magic">Jupysql: PostgreSQL via ipython magic</a>        <ol>
          <li><a href="#what-is-linecell-magic" id="markdown-toc-what-is-linecell-magic">What is line/cell magic?</a></li>
          <li><a href="#making-sql-queries-in-jupysql" id="markdown-toc-making-sql-queries-in-jupysql">Making SQL queries in jupysql</a></li>
          <li><a href="#opening-a-database-connection" id="markdown-toc-opening-a-database-connection">Opening a database connection</a></li>
          <li><a href="#closing-a-database-connection" id="markdown-toc-closing-a-database-connection">Closing a database connection</a></li>
        </ol>
      </li>
      <li><a href="#psql-the-postgressql-interactive-cli" id="markdown-toc-psql-the-postgressql-interactive-cli"><code class="language-plaintext highlighter-rouge">psql</code>, The PostgresSQL Interactive CLI</a>        <ol>
          <li><a href="#open-a-terminal-in-datahub" id="markdown-toc-open-a-terminal-in-datahub">Open a Terminal in DataHub</a></li>
          <li><a href="#opening-a-database-connection-1" id="markdown-toc-opening-a-database-connection-1">Opening a database connection</a></li>
          <li><a href="#closing-a-database-connection-1" id="markdown-toc-closing-a-database-connection-1">Closing a database connection</a></li>
          <li><a href="#psql-meta-commands" id="markdown-toc-psql-meta-commands"><code class="language-plaintext highlighter-rouge">psql</code> Meta-commands</a></li>
          <li><a href="#terminal-commands" id="markdown-toc-terminal-commands">Terminal commands</a></li>
        </ol>
      </li>
      <li><a href="#postgresql-details" id="markdown-toc-postgresql-details">PostgreSQL details</a>        <ol>
          <li><a href="#postgres-connection-urls" id="markdown-toc-postgres-connection-urls">Postgres Connection URLs</a>            <ol>
              <li><a href="#cli-connection-arguments" id="markdown-toc-cli-connection-arguments">CLI Connection Arguments</a></li>
            </ol>
          </li>
          <li><a href="#datahubs-local-postgresql-server" id="markdown-toc-datahubs-local-postgresql-server">DataHub’s local PostgreSQL Server</a></li>
          <li><a href="#catalog-schema-relationtable-etc" id="markdown-toc-catalog-schema-relationtable-etc">Catalog, Schema, Relation/Table, etc.</a></li>
        </ol>
      </li>
      <li><a href="#local-setup" id="markdown-toc-local-setup">Local Setup</a></li>
      <li><a href="#mongodb-debugging" id="markdown-toc-mongodb-debugging">MongoDB debugging</a></li>
    </ol>
  </li>
</ol>

<p><br /></p>

<p>In most of this course, you will use DataHub to work on projects. PostgreSQL has a few quirks with DataHub that will be covered in this document. However, we strongly encourage you to check out the documentation as you work:</p>
<ul>
  <li>The official <a href="https://www.postgresql.org/docs/14/index.html" target="\_blank">PostgreSQL v14 documentation</a> is great and can even be read cover-to-cover.</li>
  <li>The <code class="language-plaintext highlighter-rouge">jupysql</code> <a href="https://jupysql.ploomber.io/en/latest/" target="\_blank">documentation</a> is the primary way you will be writing SQL commands for homework submission.</li>
</ul>

<p>Please see our policies on <a href="/sp25/syllabus/#collaboration-and-integrity">collaboration</a> before working with any study groups.</p>
<h2 id="datahub">
  
  
    <a href="#datahub" class="anchor-heading" aria-labelledby="datahub"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DataHub
  
  
</h2>
    
<h3 id="working-with-jupyter-notebooks">
  
  
    <a href="#working-with-jupyter-notebooks" class="anchor-heading" aria-labelledby="working-with-jupyter-notebooks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Working with Jupyter Notebooks
  
  
</h3>
    

<p>If you are new to using Jupyter Notebooks, please see the first lab assignment of Data 100 (<a href="https://ds100.org/" target="\_blank">course website</a>). Data 101 assignments work very similarly;
there are local and hidden autograder tests, the latter of which are run after you submit your assignment through Gradescope.</p>

<p><strong>Reminder about adding new cells</strong>:
If you would like to add new cells, always do so <strong>before</strong> the cell in which you end up writing your answer. Failure to do so may break the auto-grader.</p>
<h3 id="jupyterhub-keyboard-shortcuts">
  
  
    <a href="#jupyterhub-keyboard-shortcuts" class="anchor-heading" aria-labelledby="jupyterhub-keyboard-shortcuts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> JupyterHub Keyboard Shortcuts
  
  
</h3>
    

<p>First, to enter shortcut mode/exit editing mode, press <code class="language-plaintext highlighter-rouge">Esc</code>. This will then enable you to use any of the below keyboard shortcuts.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>Keys</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>To enter shortcut mode/exit editing mode</td>
      <td><code class="language-plaintext highlighter-rouge">Esc</code></td>
    </tr>
    <tr>
      <td>Enter edit mode</td>
      <td><code class="language-plaintext highlighter-rouge">Enter</code></td>
    </tr>
    <tr>
      <td>Insert cell above</td>
      <td><code class="language-plaintext highlighter-rouge">A</code></td>
    </tr>
    <tr>
      <td>Insert cell below</td>
      <td><code class="language-plaintext highlighter-rouge">B</code></td>
    </tr>
    <tr>
      <td>Delete selected cell</td>
      <td><code class="language-plaintext highlighter-rouge">D</code> + <code class="language-plaintext highlighter-rouge">D</code> (Press <code class="language-plaintext highlighter-rouge">D</code> twice)</td>
    </tr>
    <tr>
      <td>Undo cell operation</td>
      <td><code class="language-plaintext highlighter-rouge">Z</code></td>
    </tr>
    <tr>
      <td>Copy cell</td>
      <td><code class="language-plaintext highlighter-rouge">C</code></td>
    </tr>
    <tr>
      <td>Paste cell</td>
      <td><code class="language-plaintext highlighter-rouge">V</code></td>
    </tr>
    <tr>
      <td>Paste cell above</td>
      <td><code class="language-plaintext highlighter-rouge">Shift</code> + <code class="language-plaintext highlighter-rouge">V</code></td>
    </tr>
    <tr>
      <td>Redo</td>
      <td><code class="language-plaintext highlighter-rouge">Ctrl</code> + <code class="language-plaintext highlighter-rouge">Shift</code> + <code class="language-plaintext highlighter-rouge">Z</code></td>
    </tr>
    <tr>
      <td>Undo</td>
      <td><code class="language-plaintext highlighter-rouge">Ctrl</code> + <code class="language-plaintext highlighter-rouge">Z</code></td>
    </tr>
  </tbody>
</table></div>
<h3 id="navigating-long-notebooks">
  
  
    <a href="#navigating-long-notebooks" class="anchor-heading" aria-labelledby="navigating-long-notebooks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Navigating Long Notebooks
  
  
</h3>
    

<p>JupyterLab includes an automatic table of contents on the left-hand controls that you can use to quickly jump to different sections of a notebook.</p>

<p><img src="/sp25/assets/images/notebook-toc.png" width="300px" alt="Click on the 3 lines to show the table of contents" /></p>
<h3 id="split-screen-setup">
  
  
    <a href="#split-screen-setup" class="anchor-heading" aria-labelledby="split-screen-setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Split-screen Setup
  
  
</h3>
    

<p><strong>Want to splitscreen your JupyterHub?</strong> Simply drag a tab over to a different side of your JupyterHub. We recommend splitting your screen with your Jupyter notebook in one window, and a psql terminal in another window, like so (note these are two separate connections to the database!):</p>

<p><img src="/sp25/assets/images/splitscreen.png" alt="Split Screen of DataHub" style="float: center; margin-right: 10px; width: 800px" /></p>
<h3 id="help-why-is-my-datahub-so-slow">
  
  
    <a href="#help-why-is-my-datahub-so-slow" class="anchor-heading" aria-labelledby="help-why-is-my-datahub-so-slow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Help! Why is my DataHub so slow?
  
  
</h3>
    

<p>If you are encountering any of the following issues:</p>

<ul>
  <li>Your SQL queries are taking a long time to run</li>
  <li>Your SQL queries fail with <code class="language-plaintext highlighter-rouge">No space left on device</code></li>
  <li>Your DataHub is slow or unresponsive</li>
  <li>Your browser window becomes slow or laggy</li>
</ul>

<p>Then, you may have <em>run out of disk or memory space</em> on your DataHub server. Here is a list of things you can do to fix this:</p>

<ol>
  <li>
    <p><strong>Restart your current Jupyter kernel</strong>. To do so, go to Kernel -&gt; Restart Kernel and clear outputs of all cells. Then, refresh the page or navigate back to <a href="https://data101.datahub.berkeley.edu/" target="\_blank">https://data101.datahub.berkeley.edu</a>.</p>
  </li>
  <li>
    <p><strong>Check your display limits</strong>. If your row display limit is unbounded, then your notebook will crash. Clear all cell output and insert a cell close to the top of the notebook that sets the display limit to a more reasonable size, like <code class="language-plaintext highlighter-rouge">%config SqlMagic.displaylimit = 50</code></p>
  </li>
  <li>
    <p><strong>Clear (all) cell outputs</strong> to reduce the amount of text your browser needs to load/render. In general, the total amount of content in a notebook can contribute to it feeling slow to navigate. If you see a lot of log output, for example, you can right click on the cell and clear just that cell’s output.</p>
  </li>
  <li>
    <p><strong>Close Unneeded Files &amp; Notebooks</strong>. Even files that aren’t actively displayed can have an impact on your current session. If you find yourself needing to jump between two tabs within JupyterLab, it may be more stable to open two <em>browser</em> tabs. (The best experience depends highly on the specifics of your browser, computer’s memory and other settings.)</p>
  </li>
  <li>
    <p><strong>Close all Jupyter kernels</strong> other than the one that you are currently working on. To do so, go to the left sidebar and click on the stop button (dark circle with a light inscribed square). Go to Kernels, hover over each item, and hit the X button. Or, click “Shut Down All” with all notebooks still open, then manually start your kernel in the desired notebook.</p>
  </li>
  <li><strong>Run <a href="https://www.postgresql.org/docs/current/sql-vacuum.html"><code class="language-plaintext highlighter-rouge">VACUUM FULL</code></a>.</strong> This command will instruct PostgreSQL to try to reclaim some space. To do so, run <code class="language-plaintext highlighter-rouge">!psql postgresql://jovyan@127.0.0.1:5432/imdb -c 'VACUUM FULL'</code>
    <ul>
      <li>If your notebook is already unresponsive, you can run this command in a terminal window instead. To do so, go to File -&gt; New -&gt; Terminal. Then, run type <code class="language-plaintext highlighter-rouge">psql postgresql://jovyan@127.0.0.1:5432/imdb -c 'VACUUM FULL'</code> (notice that we don’t need to type <code class="language-plaintext highlighter-rouge">!</code> in the terminal).</li>
    </ul>
  </li>
  <li>
    <p><strong>Drop and re-create your database.</strong> To do so, run the database setup commands in the beginning of your project notebook that includes the <code class="language-plaintext highlighter-rouge">DROP DATABASE</code> and <code class="language-plaintext highlighter-rouge">CREATE DATABASE</code> commands.</p>

    <p>To find out the <strong>size of all current databases</strong>, run</p>

    <ul>
      <li>In Jupyter notebook: <code class="language-plaintext highlighter-rouge">!psql postgresql://jovyan@127.0.0.1:5432/ -c '\l+'</code></li>
      <li>In a Terminal outside of a psql session: <code class="language-plaintext highlighter-rouge">!psql postgresql://jovyan@127.0.0.1:5432/ -c '\l+'</code></li>
      <li>In an active psql session: <code class="language-plaintext highlighter-rouge">\l+</code></li>
    </ul>

    <p>If you are unable to drop the database, it might be because you have other open connections to the database. Run the below to <strong>terminate all other connections</strong> (replace <code class="language-plaintext highlighter-rouge">imdb</code> with your database name):</p>

    <ul>
      <li>In Jupyter Notebook, make a new cell. Make sure you replace the syntax with the desired database (e.g., below it is <code class="language-plaintext highlighter-rouge">imdb</code>) <code class="language-plaintext highlighter-rouge">!psql postgresql://jovyan@127.0.0.1:5432/imdb -c 'SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = current_database()  AND pid &lt;&gt; pg_backend_pid();'</code></li>
      <li>In <code class="language-plaintext highlighter-rouge">psql</code>, run the following command. Make sure you are conneted to the target database first.
        <ul>
          <li>To connect to <code class="language-plaintext highlighter-rouge">imdb</code> and delete all other <code class="language-plaintext highlighter-rouge">imdb</code> connections, use the meta-command <code class="language-plaintext highlighter-rouge">\c imdb</code>.</li>
          <li>Then, run <code class="language-plaintext highlighter-rouge">SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = current_database()  AND pid &lt;&gt; pg_backend_pid();</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Restart your DataHub server.</strong> To do so, go to File -&gt; Hub Control Panel -&gt; Stop My Server. Then, refresh the page or navigate back to <a href="https://data101.datahub.berkeley.edu/" target="\_blank">https://data101.datahub.berkeley.edu</a>.</p>
  </li>
  <li>
    <p><strong>Restart your Web Browser</strong>. Sometimes, simply refreshing a browser tab can improve performance. However, completely quitting your browser can force it to clear up memory and release additional resources. If you don’t wish to close all tabs, then closing a tab (or window) and making a new one can also help with performance problems.</p>
  </li>
  <li>If none of the above work, please post on <a href="https://edstem.org/us/courses/43068/discussion/" target="\_blank">Ed</a> with the following information:
    <ul>
      <li>Your DataHub username (your @berkeley.edu name)</li>
      <li>The project you are working on</li>
      <li>The output of the following commands:</li>
    </ul>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">!df -h</code></li>
      <li><code class="language-plaintext highlighter-rouge">!free -h</code></li>
      <li><code class="language-plaintext highlighter-rouge">!psql -c 'SELECT pg_size_pretty(pg_database_size(current_database()))'</code></li>
    </ul>
  </li>
</ol>
<h3 id="help-i-cant-export-my-notebook-to-a-pdf">
  
  
    <a href="#help-i-cant-export-my-notebook-to-a-pdf" class="anchor-heading" aria-labelledby="help-i-cant-export-my-notebook-to-a-pdf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Help! I can’t export my notebook to a PDF
  
  
</h3>
    

<p>If you are running the <code class="language-plaintext highlighter-rouge">grader.export(...)</code> cell and you receive an error that looks similar to <code class="language-plaintext highlighter-rouge">LatexFailed: PDF creating failed, captured latex output</code> which is preventing you from exporting your Jupyter notebook to a PDF, this is likely because there are unescaped LaTeX special characters (such as <code class="language-plaintext highlighter-rouge">\</code>, <code class="language-plaintext highlighter-rouge">{</code>, <code class="language-plaintext highlighter-rouge">}</code>, <code class="language-plaintext highlighter-rouge">_</code>) in your notebook. Things you can do to troubleshoot:</p>

<ul>
  <li>Read the <em>entire</em> error message carefully. It is probably very long, but somewhere in the message it will say which text in your notebook is causing the error. Here is an example excerpt from an error message:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>! Undefined control sequence.
l.349 ...r materialized view is much smaller\faster
                                                 than for
?
! Emergency stop.
l.349 ...r materialized view is much smaller\faster
                                                 than for
</code></pre></div>    </div>
    <ul>
      <li>The special character <code class="language-plaintext highlighter-rouge">\</code> is reserved in LaTeX and caused the issue in this case. To fix this, use <code class="language-plaintext highlighter-rouge">/</code> instead.</li>
    </ul>
  </li>
  <li>Make sure that the cells you made or modified are Markdown or Code cells, rather than Raw cells. You can change the type of your cell by clicking on the cell to select it, and then clicking on the dropdown at the top of your notebook to change the cell type.</li>
</ul>
<h2 id="jupysql-postgresql-via-ipython-magic">
  
  
    <a href="#jupysql-postgresql-via-ipython-magic" class="anchor-heading" aria-labelledby="jupysql-postgresql-via-ipython-magic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Jupysql: PostgreSQL via ipython magic
  
  
</h2>
    
<h3 id="what-is-linecell-magic">
  
  
    <a href="#what-is-linecell-magic" class="anchor-heading" aria-labelledby="what-is-linecell-magic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is line/cell magic?
  
  
</h3>
    

<p>Before getting started, read about line magic (<code class="language-plaintext highlighter-rouge">%</code>) and cell magic (<code class="language-plaintext highlighter-rouge">%%</code>) <a href="https://www.tutorialspoint.com/jupyter/ipython_magic_commands.htm" target="\_blank">on TutorialsPoint</a>. These commands will be used extensively in this project and future projects to aid us in running SQL queries.</p>

<p>In Jupyter Notebooks, a <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">cell ‘magic’ command</a> is a special command that is preceded by two percentage signs (%%). Cell magics operate on entire cells and are used to change the behavior of the entire cell. They are not part of the Python language itself but are specific to the Jupyter environment. They help us do a lot of cool things, like run SQL commands directly within Jupyter! For some questions with cell magic, we will be saving the literal query string with <a href="https://jupysql.ploomber.io/en/latest/api/magic-snippets.html">query snippets</a> using <code class="language-plaintext highlighter-rouge">--save</code>, as illustrated below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%%sql --save query_result &lt;&lt;
SELECT * FROM table ...
</code></pre></div></div>

<p>To call SQL commands, we use the Python package <code class="language-plaintext highlighter-rouge">jupysql</code>. We strongly recommend you check out the <a href="https://jupysql.ploomber.io/en/latest/" target="\_blank"><code class="language-plaintext highlighter-rouge">jupysql</code> documentation</a>. It has a lot of hidden gems!</p>

<p>To load jupysql, run:</p>

<p><code class="language-plaintext highlighter-rouge">%load_ext sql</code></p>

<p>You will often seen this written as the following, which lets you reload the extension multiple times if there is an issue.</p>

<p><code class="language-plaintext highlighter-rouge">%reload_ext sql</code></p>
<h3 id="making-sql-queries-in-jupysql">
  
  
    <a href="#making-sql-queries-in-jupysql" class="anchor-heading" aria-labelledby="making-sql-queries-in-jupysql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Making SQL queries in jupysql
  
  
</h3>
    

<p>Here are the two ways of writing a SQL query and storing the query result into a Python variable <code class="language-plaintext highlighter-rouge">result</code>:</p>
<ul>
  <li>Single-line magic: <code class="language-plaintext highlighter-rouge">result = %sql SELECT * FROM table ...</code></li>
  <li>Multi-line cell magic:</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="k">sql</span> <span class="k">result</span> <span class="o">&lt;&lt;</span>
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="k">table</span> <span class="p">...</span>
</code></pre></div></div>

<!--
For some questions with multi-line cell magic, we will also be saving the literal query string with [query snippets](https://jupysql.ploomber.io/en/latest/api/magic-snippets.html) using `--save`:

``%%sql --save query result << select * FROM table ...``
-->
<h3 id="opening-a-database-connection">
  
  
    <a href="#opening-a-database-connection" class="anchor-heading" aria-labelledby="opening-a-database-connection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Opening a database connection
  
  
</h3>
    

<p>Before running any SQL queries, you must have a working connection to a database on a Postgres server. It usually looks something like this, which connects to the Postgres server (at the local IP address, using the user <code class="language-plaintext highlighter-rouge">jovyan</code>) and the database <code class="language-plaintext highlighter-rouge">imdb</code>.</p>

<p><code class="language-plaintext highlighter-rouge">%sql postgresql://jovyan@127.0.0.1:5432/imdb</code></p>
<h3 id="closing-a-database-connection">
  
  
    <a href="#closing-a-database-connection" class="anchor-heading" aria-labelledby="closing-a-database-connection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Closing a database connection
  
  
</h3>
    

<p>You may sometimes wnat to close the database connection, in case you want to delete your database and start from a new copy. To close the connection, you can either restart your kernel or explicitly run the following in its own cell:</p>

<p><code class="language-plaintext highlighter-rouge">%sql --close postgresql://jovyan@127.0.0.1:5432/imdb</code></p>

<p>If that’s not working, see the bottom of this page for how to relaunch your DataHub instance.</p>
<h2 id="psql-the-postgressql-interactive-cli">
  
  
    <a href="#psql-the-postgressql-interactive-cli" class="anchor-heading" aria-labelledby="psql-the-postgressql-interactive-cli"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">psql</code>, The PostgresSQL Interactive CLI
  
  
</h2>
    

<p>The <code class="language-plaintext highlighter-rouge">psql</code> program is the PostgreSQL <em>interpreter</em> and CLI, or Command-Line Interface. Knowing <code class="language-plaintext highlighter-rouge">psql</code> is very useful to understand what your database looks like, execute meta-commands, and explore quick queries.</p>

<p>Just like when you type <code class="language-plaintext highlighter-rouge">python</code> in a Terminal, <code class="language-plaintext highlighter-rouge">psql</code>’s primary use is interactively run queries and commands against a database.</p>
<h3 id="open-a-terminal-in-datahub">
  
  
    <a href="#open-a-terminal-in-datahub" class="anchor-heading" aria-labelledby="open-a-terminal-in-datahub"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Open a Terminal in DataHub
  
  
</h3>
    

<p>To open a Terminal in DataHub, Navigate to Data101’s DataHub, then go to File → New → Terminal. <strong>Note</strong>: Do not open a Terminal on your local machine; it does not know how to connect to DataHub’s server, much less your DataHub’s Postgres server!</p>
<h3 id="opening-a-database-connection-1">
  
  
    <a href="#opening-a-database-connection-1" class="anchor-heading" aria-labelledby="opening-a-database-connection-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Opening a database connection
  
  
</h3>
    

<p>Use either command to connect to the <code class="language-plaintext highlighter-rouge">imdb</code> database, if it has been created:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql postgresql://127.0.0.1:5432/imdb
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql -h localhost -d imdb
</code></pre></div></div>

<p>If no database has been created:</p>
<ul>
  <li>You will likely get this error:
<code class="language-plaintext highlighter-rouge">psql: error: connection to server at '127.0.0.1', port 5432 failed: FATAL:  database "imdb" does not exist"</code></li>
  <li>
    <p>In this case, you can still connect to the server and list databases, etc., as follows:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql <span class="nt">-h</span> localhost
</code></pre></div>    </div>
  </li>
  <li>However, you won’t be able to see any relations, because this default connection cannot access what’s in <code class="language-plaintext highlighter-rouge">imdb</code>.</li>
  <li>To create the <code class="language-plaintext highlighter-rouge">imdb</code> database, see the corresponding Jupyter notebook and run the cells that contain commands such as <code class="language-plaintext highlighter-rouge">CREATE DATABASE</code>. For Fall 2024, <code class="language-plaintext highlighter-rouge">imdb</code> is created in the Project 1 notebook. You may which to run <code class="language-plaintext highlighter-rouge">createdb -h localhost [dbname]</code> to make a new, empty database.</li>
</ul>
<h3 id="closing-a-database-connection-1">
  
  
    <a href="#closing-a-database-connection-1" class="anchor-heading" aria-labelledby="closing-a-database-connection-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Closing a database connection
  
  
</h3>
    
<p><code class="language-plaintext highlighter-rouge">\q</code>: This exits out of the <code class="language-plaintext highlighter-rouge">psql</code> program and also closes your current connections.</p>

<p><code class="language-plaintext highlighter-rouge">\c &lt;databasename&gt;</code>: This keeps your <code class="language-plaintext highlighter-rouge">psql</code> client open, closes your current database conection, and opens a connection to <code class="language-plaintext highlighter-rouge">&lt;databasename&gt;</code>.</p>
<h3 id="psql-meta-commands">
  
  
    <a href="#psql-meta-commands" class="anchor-heading" aria-labelledby="psql-meta-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">psql</code> Meta-commands
  
  
</h3>
    

<p>psql meta-commands doc: <a href="https://www.postgresql.org/docs/14/app-psql.html">list</a></p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Meta-Command</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\?</code></td>
      <td>Help</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\l</code></td>
      <td>Lists databases</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\d</code></td>
      <td>Lists relations</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\d tablename</code></td>
      <td>List schema of the relation <code class="language-plaintext highlighter-rouge">tablename</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\q</code></td>
      <td>Quit psql</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">\x auto</code></td>
      <td>Expanded view of records. To toggle off, <code class="language-plaintext highlighter-rouge">\x off</code>.</td>
    </tr>
  </tbody>
</table></div>

<p><strong>Making queries</strong>: You can write queries in <code class="language-plaintext highlighter-rouge">psql</code>! To write queries that span multiple lines, simply use the newline key (i.e., <code class="language-plaintext highlighter-rouge">&lt;Return&gt;</code>). However, to execute a query in <code class="language-plaintext highlighter-rouge">psql</code>, you must use the <strong>semicolon</strong>. This is generally good style, anyway!</p>

<p><strong>Display screen</strong>: If a query’s result will span more than the available display screen, <code class="language-plaintext highlighter-rouge">psql</code> will launch a different display screen. You can navigate this screen by pressing <code class="language-plaintext highlighter-rouge">&lt;space&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;return&gt;</code> to display more, up/down arrows to scroll up and down, or use the <code class="language-plaintext highlighter-rouge">page up</code>/<code class="language-plaintext highlighter-rouge">page down</code> keys, and <code class="language-plaintext highlighter-rouge">q</code> to exit the query view.</p>
<h3 id="terminal-commands">
  
  
    <a href="#terminal-commands" class="anchor-heading" aria-labelledby="terminal-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Terminal commands
  
  
</h3>
    

<p>Here are some Terminal shortcuts to help you better navigate <code class="language-plaintext highlighter-rouge">psql</code>. (These commands are standard across all Unix terminal envrionments, including macOS.)</p>

<div class="table-wrapper"><table class="table">
  <thead>
    <tr>
      <th style="text-align: center"><strong>Keys</strong></th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><kbd>^ c</kbd></td>
      <td style="text-align: left">Cancel current operation</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>^ a</kbd></td>
      <td style="text-align: left">Jump to beginning of line</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>^ e</kbd></td>
      <td style="text-align: left">Jump to end of line</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>^ left</kbd></td>
      <td style="text-align: left">Jump to previous word</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>^ right</kbd></td>
      <td style="text-align: left">Jump to next word</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>space</kbd></td>
      <td style="text-align: left">If currently exploring a query result, see more of the result.</td>
    </tr>
    <tr>
      <td style="text-align: center"><kbd>q</kbd></td>
      <td style="text-align: left">If currently exploring a query result, exit from the result.</td>
    </tr>
  </tbody>
</table></div>

<p><kbd>^</kbd> is the symbol for the <code class="language-plaintext highlighter-rouge">control</code> key.</p>
<h2 id="postgresql-details">
  
  
    <a href="#postgresql-details" class="anchor-heading" aria-labelledby="postgresql-details"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PostgreSQL details
  
  
</h2>
    
<h3 id="postgres-connection-urls">
  
  
    <a href="#postgres-connection-urls" class="anchor-heading" aria-labelledby="postgres-connection-urls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Postgres Connection URLs
  
  
</h3>
    

<p>Throughout this course you will see a number of ways to connect to a database server. These connection strings are like URLs, but won’t work in a web browser. Instead tools like SQLAlchemy in Python (and others in Ruby, Java, etc.) use the same URL format to establish a connection to a database server, whether it’s on a local machine or connected to the internet.</p>

<p>Consider the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postgresql://jovyan@127.0.0.1:5432/imdb
</code></pre></div></div>

<p>This has the following components:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[db driver]://[username][:password]@[server address][:port]/[database name]
</code></pre></div></div>

<p>In many cases, parts of these connection URIs, like the port, username, or database can ommitted if using the defaults.</p>
<h4 id="cli-connection-arguments">
  
  
    <a href="#cli-connection-arguments" class="anchor-heading" aria-labelledby="cli-connection-arguments"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CLI Connection Arguments
  
  
</h4>
    

<p>All of the default tools like <code class="language-plaintext highlighter-rouge">psql</code>, <code class="language-plaintext highlighter-rouge">createdb</code>, <code class="language-plaintext highlighter-rouge">dropdb</code>, that come with a PostgreSQL installation, and many other tools allow you to specify the connection more explicitly, which can be convenient when using the command line.</p>

<p>This is the equivalent to the previous URL method:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psql <span class="nt">-h</span> localhost <span class="nt">-d</span> imdb
</code></pre></div></div>

<blockquote class="note">
  <ul>
    <li><code class="language-plaintext highlighter-rouge">psql -h localhost -d imdb -U jovyan -p 5432</code> would be equivalent to passing all of the arguments in the connection URL.</li>
    <li>On DataHub, you will always need to specify <code class="language-plaintext highlighter-rouge">-h localhost</code> to connect to the locally running server.</li>
    <li>Passing <code class="language-plaintext highlighter-rouge">-d</code> is usually done for convenience, but is not required. In this case you will not be connected to a specific database.</li>
    <li><code class="language-plaintext highlighter-rouge">-U</code> will default to <code class="language-plaintext highlighter-rouge">joyvan</code> on DataHub, but is otherwise the current user.</li>
    <li><code class="language-plaintext highlighter-rouge">-p</code> has a default value of 5432 for Postgres.</li>
  </ul>
</blockquote>

<p>Try running <code class="language-plaintext highlighter-rouge">psql --help</code> for more explanation. (Outside of this class, you may find the need to provide a password, especially when connecting to a remote server.)</p>
<h3 id="datahubs-local-postgresql-server">
  
  
    <a href="#datahubs-local-postgresql-server" class="anchor-heading" aria-labelledby="datahubs-local-postgresql-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DataHub’s local PostgreSQL Server
  
  
</h3>
    

<p>Every time you want to work with a database, you need to connect to a <em>database server</em>. On the Data101 DataHub, a Postgres server is automatically started in the background:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postgresql://jovyan@127.0.0.1:5432/imdb
</code></pre></div></div>

<ul>
  <li>connect using <code class="language-plaintext highlighter-rouge">postgresql</code> as the database driver</li>
  <li>connect using JupyterHub username <code class="language-plaintext highlighter-rouge">joyvan</code> (why is the default username? see here <a href="https://github.com/jupyter/docker-stacks/issues/358">Jupyter</a>, <a href="https://github.com/jupyterhub/repo2docker/issues/366">JupyterHub</a>)</li>
  <li><code class="language-plaintext highlighter-rouge">127.0.0.1</code> is a <a href="https://datatracker.ietf.org/doc/html/rfc6890#section-2.2.2">“loopback” IP</a> address representing the current machine, which is also mapped to hostname <code class="language-plaintext highlighter-rouge">localhost</code>.</li>
  <li>connect to the database <code class="language-plaintext highlighter-rouge">imdb</code> on this server. Note that if the <code class="language-plaintext highlighter-rouge">imdb</code> database has not yet been created, this connection may fail.</li>
</ul>
<h3 id="catalog-schema-relationtable-etc">
  
  
    <a href="#catalog-schema-relationtable-etc" class="anchor-heading" aria-labelledby="catalog-schema-relationtable-etc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Catalog, Schema, Relation/Table, etc.
  
  
</h3>
    

<ul>
  <li>
    <p>StackOverflow: <a href="https://stackoverflow.com/questions/7022755/whats-the-difference-between-a-catalog-and-a-schema-in-a-relational-database">Catalog, Schema, Relation/Table differences</a></p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">pg_toast</code>: TOAST storage schema <a href="https://www.postgresql.org/docs/current/storage-toast.html">documentation 73.2</a></li>
  <li><code class="language-plaintext highlighter-rouge">pg_catalog</code>: System catalog schema <a href="https://www.postgresql.org/docs/current/ddl-schemas.html#DDL-SCHEMAS-CATALOG">documentation 5.9.5</a></li>
</ul>
<h2 id="local-setup">
  
  
    <a href="#local-setup" class="anchor-heading" aria-labelledby="local-setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Local Setup
  
  
</h2>
    

<p>While you are welcome to set up everything locally, when grading we will assume that your submission was developed on DataHub. If you would like to develop locally, please make sure you have the following installed:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">otter-grader==5.1.3</code></li>
  <li><code class="language-plaintext highlighter-rouge">jupysql==0.10.0</code></li>
  <li><code class="language-plaintext highlighter-rouge">pgspecial=1.13.1</code></li>
  <li><code class="language-plaintext highlighter-rouge">psycopg==3.2.1</code></li>
  <li><code class="language-plaintext highlighter-rouge">mongodb</code></li>
  <li>PostgreSQL server. For Mac, you can use <a href="https://postgresapp.com/">Postgres.app</a>, or <a href="https://formulae.brew.sh/formula/postgresql@16">homebrow</a> (<code class="language-plaintext highlighter-rouge">brew install postgresql</code>).</li>
</ul>

<p>Either way, we recommend you always work on DataHub, as staff will not be able to debug/support local setup issues.</p>
<h2 id="mongodb-debugging">
  
  
    <a href="#mongodb-debugging" class="anchor-heading" aria-labelledby="mongodb-debugging"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MongoDB debugging
  
  
</h2>
    

<p>To prevent bracket mismatches while creating your queries, it is recommended to turn on “Auto Close Brackets” via Settings in JupyterHub. Furthermore, since we are using Python dictionaries as our query filter, make sure to wrap all keys and values inside quotes.</p>

          

          
        </main>
        

  <hr>
  <footer>
    
      <p><a href="#top" id="back-to-top">Back to Top</a></p>
    

    <!-- This file comes from Just The Docs.
 This footer should be included on all EECS/DS sites.
--><p class="text-small text-grey-dk-100 my-1">
  <a rel="nofollow noopener" href="https://dap.berkeley.edu/get-help/report-web-accessibility-issue" target="_blank" class="pr-2">Accessibility</a>
  <a rel="nofollow noopener" href="https://ophd.berkeley.edu/policies-and-procedures/nondiscrimination-policy-statement" target="_blank" class="px-2">Nondiscrimination</a>
</p>

<!-- Use this to add additional content. -->
<p class="text-small text-lighter m-0">
  Copyright ©2025, Regents of the University of Californa and respective authors.
</p>

<p class="fs-1 text-lighter my-1">
  This site is built following the <a href="https://github.com/berkeley-eecs/berkeley-class-site" target="_blank" rel="noopener">Berkeley Class Site</a> template, which is generously based on the <a href="https://github.com/kevinl/just-the-class" target="_blank" rel="noopener">Just the Class</a>, and <a href="https://github.com/just-the-docs/just-the-docs" target="_blank" rel="noopener">Just the Docs</a> templates.
</p>


    
      <div class="d-flex mt-2">
        
        
      </div>
    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

